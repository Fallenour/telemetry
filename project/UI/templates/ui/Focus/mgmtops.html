<!DOCTYPE html>
<html lang="en">
{% load static %}
{% include 'ui/Focus/sidebar.html' %}
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Focus Admin: Data Table</title>
    {% load static %}
    <!-- ================= Favicon ================== -->
    <!-- Standard -->
    <link rel="shortcut icon" href="http://placehold.it/64.png/000/fff">
    <!-- Retina iPad Touch Icon-->
    <link rel="apple-touch-icon" sizes="144x144" href="http://placehold.it/144.png/000/fff">
    <!-- Retina iPhone Touch Icon-->
    <link rel="apple-touch-icon" sizes="114x114" href="http://placehold.it/114.png/000/fff">
    <!-- Standard iPad Touch Icon-->
    <link rel="apple-touch-icon" sizes="72x72" href="http://placehold.it/72.png/000/fff">
    <!-- Standard iPhone Touch Icon-->
    <link rel="apple-touch-icon" sizes="57x57" href="http://placehold.it/57.png/000/fff">

    <!-- Styles --->
    <link href="{% static "css/lib/font-awesome.min.css" %}" rel="stylesheet">
    <link href="{% static "css/lib/themify-icons.css" %}" rel="stylesheet">
    <link href="{% static "css/lib/data-table/buttons.bootstrap.min.css" %}" rel="stylesheet" />
    <link href="{% static "css/lib/menubar/sidebar.css" %}" rel="stylesheet">
    <link href="{% static "css/lib/bootstrap.min.css" %}" rel="stylesheet">
    <link href="{% static "css/lib/helper.css" %}" rel="stylesheet">
    <link href="{% static "css/style.css" %}" rel="stylesheet">

    <script type="text/javascript" class="init">
        $(document).ready(function() {
            $('#example').DataTable( {
                dom: 'Bfrtip',
                buttons: [
                    'copyHtml5',
                    'excelHtml5',
                    'csvHtml5',
                    'pdfHtml5'
                ]
            } );
        } );
    </script>
</head>

<body>

    <div class="content-wrap">
      <div class="main">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-8 p-r-0 title-margin-right">
              <div class="page-header">
                <div class="page-title">
                  <h1>Hello, <span>Welcome Here</span></h1>
                </div>
              </div>
            </div>
            <!-- /# column -->
            <div class="col-lg-4 p-l-0 title-margin-left">
              <div class="page-header">
                <div class="page-title">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                    <li class="breadcrumb-item active">Chartjs</li>
                  </ol>
                </div>
              </div>
            </div>
            <!-- /# column -->
          </div>
          <!-- /# row -->
          <section id="main-content">
            <div class="row">
              <div class="col-lg-6">
                <div class="card">
                  <div class="card-title">
                    <h4>Total Transactions per Year</h4>
                  </div>
                  <div class="sales-chart">
                    <canvas id="sales-chart"></canvas>
                  </div>
                </div>
              </div>
              <!-- /# column -->
              <div class="col-lg-6">
                <div class="card">
                  <div class="card-title">
                    <h4>Total Fraud per Year</h4>
                  </div>
                  <div class="sales-chart">
                    <canvas id="team-chart"></canvas>
                  </div>
                </div>
                <!-- /# card -->
              </div>
              <!-- /# column -->
            </div>
            <!-- /# row -->
            <div class="row">
              <!-- Bar Chart -->
              <div class="col-sm-12 col-md-6">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Transactions Valid/Fraud</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="barChart"></canvas>
                  </div>
                </div>
              </div>
              <!-- Radar Chart -->
              <div class="col-sm-12 col-md-6">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Fraud Types Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="radarChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <!-- Line Chart -->
              <div class="col-sm-12 col-md-8">
                <div class="panel panel-bd lobidrag">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Service Level Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="lineChart"></canvas>
                  </div>
                </div>
              </div>
              <!-- Pie Chart -->
              <div class="col-sm-6 col-md-4">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Fraud Types Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="pieChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <!-- Doughnut Chart -->
              <div class="col-sm-6 col-md-4">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Account Type Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="doughutChart"></canvas>
                  </div>
                </div>
              </div>
              <!-- Polar Chart -->
              <div class="col-sm-6 col-md-4">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Fraud Popularity Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="polarChart"></canvas>
                  </div>
                </div>
              </div>
              <!-- Single Bar Chart -->
              <div class="col-sm-6 col-md-4">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-title">
                      <h4>Customer Transactions Per Day Chart</h4>
                    </div>
                  </div>
                  <div class="panel-body">
                    <canvas id="singelBarChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

          </section>


                <!-- /# row -->
                <section id="main-content">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-body">
                                <h4 class="card-title">Data Table</h4>
                                <div class="table-responsive">
                                    <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4">
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <table class="table table-striped table-bordered zero-configuration dataTable" id="bootstrap-data-table-export" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info">
                                        <thead>
                                            <tr role="row">
                                                <th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="System Name: activate to sort column descending" aria-sort="ascending" style="width: 100px;">System</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Event Description: activate to sort column ascending" style="width: 200px;">Event ID</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Event Description: activate to sort column ascending" style="width: 200px;">Event Description</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Cust Name: activate to sort column ascending" style="width: 150px;">Cust Name</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Account ID: activate to sort column ascending" style="width: 87px;">Account ID</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Location: activate to sort column ascending" style="width: 177px;">Location</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Link: activate to sort column ascending" style="width: 50px;">Function</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Link: activate to sort column ascending" style="width: 50px;">Link</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Event Date & Time: activate to sort column ascending" style="width: 225px;">Event Date & Time</th>
                                                <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Score: activate to sort column ascending" style="width: 20px;">Score</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                        {% for event in event_list %}
                                        <tr role="row" {% if event.score <= -40 %}class="bg-danger"{% elif event.score <= 49 %} class="table-warning"{% elif event.score <= 50 %}class="table-info"{% endif %}>
                                                    <td class="sorting_1">{{ event.system }}</td>
                                                    <td class="">{{ event.srcip }}</td>
                                                    <td class="">{{ event.dstip }}</td>
                                                    <td>{{ event.srcport }}</td>
                                                    <td>{{ event.dstport }}</td>
                                                    <td>{{ event.md5hash }}</td>
                                                    <td>{{ event.virustotalscore }}</td>
                                                    <td>{{ event.internalthreatscore}}</td>
                                                    <td>{{ event.ctiscore }}</td>
                                                    <td>{{ event.dnsdisplayname }}</td>
                                                    <td>{{ event.dnsresolvedname }}</td>
                                                    <td>{{ event.payload }}</td>
                                                    <td>{{ event.score }}</td>
                                                    <td>{{ event.contract }}</td>
                                                    <td><a href="{{ event.link }}" target="_blank"> Link</a></td>
                                        </tr>
                                        {% endfor %}
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <!-- /# card -->
                        </div>
                        <!-- /# column -->
                    </div>
                    <!-- /# row -->

                    <div class="row">
                        <div class="col-lg-12">
                            <div class="footer">
                                <p>2018 © Admin Board. - <a href="#">example.com</a></p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>




    <!--  Chart js -->
    <script type="text/javascript" src="{% static 'js/lib/chart-js/Chart.bundle.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-chartjs.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-saleschart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-linechart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-teamchart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-barchart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-radarchart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-piechart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-doughutchart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-polarchart.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/lib/chart-js/ops-singlebarchart.js' %}"></script>



    <!-- jquery vendor -->
    <script src="{% static "js/lib/jquery.min.js" %}"></script>
    <script src="{% static "js/lib/jquery.nanoscroller.min.js" %}"></script>
    <!-- nano scroller -->
    <script src="{% static "js/lib/menubar/sidebar.js" %}"></script>
    <script src="{% static "js/lib/preloader/pace.min.js" %}"></script>
    <!-- sidebar -->

    <!-- bootstrap -->

    <script src="{% static "js/lib/bootstrap.min.js" %}"></script><script src="{% static "js/scripts.js" %}"></script>
    <!-- scripit init-->
    <script src="{% static "js/lib/data-table/datatables.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/buttons.dataTables.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/dataTables.buttons.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/buttons.flash.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/jszip.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/pdfmake.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/vfs_fonts.js" %}"></script>
    <script src="{% static "js/lib/data-table/buttons.html5.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/buttons.print.min.js" %}"></script>
    <script src="{% static "js/lib/data-table/datatables-init.js" %}"></script>




    <script>
      $(document).ready(function () {
        var endpoint = '/api/chart/data/';
        var defaultData = [];
        var labels = [];
        $.ajax({
          method: 'GET',
          url: endpoint,
          success: function (data) {
            labels = data.labels;
            defaultData = data.default;
            setChart();
          },
          error: function (error_data) {
            console.log('error');
            console.log(error_data);
          },
        });

        function setChart() {
          var ctx = document.getElementById('myChart');
          var ctx2 = document.getElementById('myChart2');
          var myChart = new Chart(ctx2, {
            type: 'bar',
            data: {
              labels: labels,
              datasets: [
                {
                  label: '# of Votes',
                  data: defaultData,
                  backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                  ],
                  borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                  ],
                  borderWidth: 1,
                },
              ],
            },
            options: {
              scales: {
                yAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                    },
                  },
                ],
              },
            },
          });

          var myChart = new Chart(ctx, {
            type: 'polarArea',
            data: {
              labels: labels,
              datasets: [
                {
                  label: '# of Votes',
                  data: defaultData,
                  backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)',
                  ],
                  borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)',
                  ],
                  borderWidth: 1,
                },
              ],
            },
            options: {
              scales: {
                yAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                    },
                  },
                ],
              },
            },
          });
        }
        // var ctx = document.getElementById("myChart");
      });
    </script>

</body>

</html>